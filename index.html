<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kheil Pro Sniper - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø³ØªÙ‚Ù„Ø©</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src='https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js'></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap');
        * { font-family: 'Cairo', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); }
        .neon-text { color: #4ade80; text-shadow: 0 0 10px rgba(74, 222, 128, 0.5); }
        .card { background: white; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.05); }
        
        .step-active { background: #4ade80; color: #064e3b; border-color: #4ade80; }
        .step-inactive { background: #f1f5f9; color: #94a3b8; }
        .step-done { background: #0f172a; color: white; }

        .loader {
            border: 4px solid #f3f3f3; border-top: 4px solid #4ade80;
            border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="bg-slate-50 min-h-screen">

    <div class="gradient-bg text-white py-8 shadow-xl">
        <div class="container mx-auto px-4 text-center">
            <h1 class="text-4xl font-black mb-2 flex justify-center items-center gap-3">
                ğŸ¦… Kheil Pro <span class="text-green-400">Native</span>
            </h1>
            <p class="text-slate-400">Ù†Ø¸Ø§Ù… ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠ (Ø¨Ø¯ÙˆÙ† Ø³ÙŠØ±ÙØ±Ø§Øª)</p>
        </div>
    </div>

    <div class="container mx-auto px-4 -mt-6">
        <div class="flex justify-center gap-2 md:gap-4">
            <div id="step1-badge" class="px-6 py-3 rounded-xl font-bold border-2 step-active transition-all">1. Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø©</div>
            <div id="step2-badge" class="px-6 py-3 rounded-xl font-bold border-2 step-inactive transition-all">2. Ø§Ù„ÙÙ„ØªØ±Ø©</div>
            <div id="step3-badge" class="px-6 py-3 rounded-xl font-bold border-2 step-inactive transition-all">3. Ø§Ù„ØªØ­Ù„ÙŠÙ„</div>
        </div>
    </div>

    <div class="container mx-auto px-4 py-8 max-w-5xl">
        
        <div id="view-step1" class="card p-8 md:p-12 text-center">
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-slate-800 mb-2">Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†Ø§Øª Ù…Ù† Ø§Ù„ØµÙˆØ±</h2>
                <p class="text-slate-500">Ù†Ø³ØªØ®Ø¯Ù… Ù…Ø­Ø±Ùƒ Tesseract Ø§Ù„Ù…Ø­Ù„ÙŠ Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ØµÙˆØ± Ù…Ø¨Ø§Ø´Ø±Ø© ÙÙŠ Ù…ØªØµÙØ­Ùƒ.</p>
            </div>

            <div id="drop-zone" class="border-4 border-dashed border-slate-200 rounded-3xl p-10 cursor-pointer hover:bg-slate-50 hover:border-green-400 transition-all group">
                <input type="file" id="file-input" accept="image/*" class="hidden">
                <div class="text-6xl mb-4 grayscale group-hover:grayscale-0 transition-all">ğŸ“¸</div>
                <h3 class="text-xl font-bold text-slate-700">Ø§Ø¶ØºØ· Ù„Ø±ÙØ¹ ØµÙˆØ±Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</h3>
                <p class="text-sm text-slate-400 mt-2">ÙŠØ¯Ø¹Ù… Ù„Ù‚Ø·Ø§Øª Ø§Ù„Ø´Ø§Ø´Ø© ÙˆØ§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…ØµÙˆØ±Ø©</p>
            </div>

            <div id="process-area" class="hidden mt-8">
                <img id="img-preview" class="max-h-60 mx-auto rounded-lg shadow-lg mb-6 border-2 border-slate-200">
                <div id="progress-container" class="hidden max-w-md mx-auto">
                    <div class="flex justify-between text-sm font-bold text-slate-600 mb-1">
                        <span>Ø¬Ø§Ø±ÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù†ØµÙˆØµ...</span>
                        <span id="progress-percent">0%</span>
                    </div>
                    <div class="h-3 bg-slate-200 rounded-full overflow-hidden">
                        <div id="progress-bar" class="h-full bg-green-500 w-0 transition-all duration-300"></div>
                    </div>
                    <p class="text-xs text-slate-400 mt-2">ØªØªÙ… Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ù…Ø­Ù„ÙŠØ§Ù‹ Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø²Ùƒ</p>
                </div>
                <button id="btn-extract" class="bg-slate-900 text-white px-8 py-3 rounded-xl font-bold hover:bg-green-600 transition-all shadow-lg shadow-green-500/20">
                    âš¡ Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬
                </button>
            </div>
        </div>

        <div id="view-step2" class="hidden card p-8">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-slate-800">Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬ ÙˆØ§Ù„ÙÙ„ØªØ±Ø©</h2>
                <div class="bg-green-100 text-green-700 px-4 py-1 rounded-full font-bold text-sm">
                    ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰: <span id="count-raw">0</span>
                </div>
            </div>

            <div class="grid md:grid-cols-2 gap-8">
                <div>
                    <h3 class="font-bold text-slate-500 mb-3 text-sm">Ø§Ù„Ù†Øµ Ø§Ù„Ø®Ø§Ù… (Ù‚Ø¨Ù„ Ø§Ù„ØªÙ†Ø¸ÙŠÙ)</h3>
                    <textarea id="raw-text" class="w-full h-64 p-4 bg-slate-50 rounded-xl border border-slate-200 text-sm font-mono" readonly></textarea>
                </div>

                <div class="space-y-4">
                    <div class="bg-slate-50 p-4 rounded-xl border border-slate-200">
                        <h3 class="font-bold text-slate-800 mb-3">âš™ï¸ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„ÙÙ„ØªØ±Ø© Ø§Ù„Ù‚Ø§Ø³ÙŠØ©</h3>
                        <label class="flex items-center gap-2 mb-2 cursor-pointer">
                            <input type="checkbox" checked class="w-5 h-5 accent-green-500" id="filter-ext">
                            <span>Ø§Ù…ØªØ¯Ø§Ø¯Ø§Øª Premium ÙÙ‚Ø· (.com, .ai, .io)</span>
                        </label>
                        <label class="flex items-center gap-2 mb-2 cursor-pointer">
                            <input type="checkbox" checked class="w-5 h-5 accent-green-500" id="filter-len">
                            <span>Ø§Ù„Ø·ÙˆÙ„ Ø£Ù‚Ù„ Ù…Ù† 12 Ø­Ø±Ù</span>
                        </label>
                        <label class="flex items-center gap-2 mb-2 cursor-pointer">
                            <input type="checkbox" checked class="w-5 h-5 accent-green-500" id="filter-num">
                            <span>Ù…Ù†Ø¹ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… (No Numbers)</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="checkbox" checked class="w-5 h-5 accent-green-500" id="filter-clean">
                            <span>ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø±Ù…ÙˆØ² Ø§Ù„Ø²Ø§Ø¦Ø¯Ø©</span>
                        </label>
                    </div>
                    <button onclick="runFilter()" class="w-full bg-slate-800 text-white py-3 rounded-xl font-bold hover:bg-slate-900">ğŸ”„ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„ØªØ±Ø©</button>
                    <button onclick="goToAnalysis()" class="w-full bg-green-500 text-white py-3 rounded-xl font-bold hover:bg-green-600 shadow-lg shadow-green-500/30">â¡ï¸ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</button>
                </div>
            </div>
            
            <div id="filtered-list" class="mt-6 flex flex-wrap gap-2">
                </div>
        </div>

        <div id="view-step3" class="hidden card p-8">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-black text-slate-800">ØªÙ‚Ø±ÙŠØ± ÙƒØ­ÙŠÙ„ Ø¨Ø±Ùˆ</h2>
                <p class="text-slate-500">Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø®ÙˆØ§Ø±Ø²Ù…ÙŠ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</p>
            </div>

            <div class="overflow-x-auto">
                <table class="w-full text-right">
                    <thead>
                        <tr class="bg-slate-50 text-slate-600">
                            <th class="p-4 rounded-r-xl">Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†</th>
                            <th class="p-4">Ø§Ù„ØªØ­Ù„ÙŠÙ„ (Tags)</th>
                            <th class="p-4">Ø§Ù„Ù†Ù‚Ø§Ø· (Score)</th>
                            <th class="p-4 rounded-l-xl">Ø£Ø¯ÙˆØ§Øª</th>
                        </tr>
                    </thead>
                    <tbody id="analysis-table-body">
                        </tbody>
                </table>
            </div>
            
            <div class="mt-8 text-center">
                <button onclick="location.reload()" class="text-slate-400 hover:text-slate-600 underline">Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©</button>
            </div>
        </div>

    </div>

    <script>
        // --- 1. CONFIGURATION (Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù„Ø¹Ø¨Ø©) ---
        const PREMIUM_TLDS = ['com', 'ai', 'io', 'co', 'net', 'org', 'app'];
        const TREND_KEYWORDS = ['ai', 'gpt', 'tech', 'data', 'meta', 'soft', 'hub', 'lab', 'sys', 'bot', 'code', 'flow', 'web'];
        const BAD_KEYWORDS = ['cheap', 'free', 'buy', 'porn', 'sex', 'hack', 'crack', 'spam', 'junk', '123'];

        let rawDomains = [];
        let cleanDomains = [];

        // --- 2. UPLOAD & OCR LOGIC ---
        const fileInput = document.getElementById('file-input');
        const dropZone = document.getElementById('drop-zone');
        const imgPreview = document.getElementById('img-preview');

        dropZone.addEventListener('click', () => fileInput.click());
        fileInput.addEventListener('change', handleFile);

        function handleFile(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (ev) => {
                    imgPreview.src = ev.target.result;
                    document.getElementById('process-area').classList.remove('hidden');
                    dropZone.classList.add('hidden');
                }
                reader.readAsDataURL(file);
            }
        }

        document.getElementById('btn-extract').addEventListener('click', () => {
            const btn = document.getElementById('btn-extract');
            const progressContainer = document.getElementById('progress-container');
            const progressBar = document.getElementById('progress-bar');
            const progressPercent = document.getElementById('progress-percent');
            
            btn.classList.add('hidden');
            progressContainer.classList.remove('hidden');

            // ØªØ´ØºÙŠÙ„ Tesseract OCR
            Tesseract.recognize(
                imgPreview.src,
                'eng', // Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©
                {
                    logger: m => {
                        if (m.status === 'recognizing text') {
                            const pct = Math.floor(m.progress * 100);
                            progressBar.style.width = pct + '%';
                            progressPercent.innerText = pct + '%';
                        }
                    }
                }
            ).then(({ data: { text } }) => {
                processExtractedText(text);
            });
        });

        function processExtractedText(text) {
            document.getElementById('raw-text').value = text;
            
            // Ø§Ø³ØªØ®Ø¯Ø§Ù… Regex Ù‚ÙˆÙŠ Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø£ÙŠ Ø´ÙŠØ¡ ÙŠØ´Ø¨Ù‡ Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†
            // ÙŠØ¨Ø­Ø« Ø¹Ù†: ÙƒÙ„Ù…Ø© + Ù†Ù‚Ø·Ø© + Ø§Ù…ØªØ¯Ø§Ø¯ (Ù…Ù† 2 Ø¥Ù„Ù‰ 4 Ø­Ø±ÙˆÙ)
            const regex = /\b[a-zA-Z0-9-]+\.[a-zA-Z]{2,4}\b/g;
            const matches = text.match(regex);
            
            rawDomains = matches ? [...new Set(matches.map(d => d.toLowerCase()))] : [];
            
            switchStep(2);
            document.getElementById('count-raw').innerText = rawDomains.length;
            runFilter();
        }

        // --- 3. FILTER LOGIC (Ù…Ø­Ø±Ùƒ Ø§Ù„ÙÙ„ØªØ±Ø© Ø§Ù„Ù…Ø­Ù„ÙŠ) ---
        function runFilter() {
            const useExt = document.getElementById('filter-ext').checked;
            const useLen = document.getElementById('filter-len').checked;
            const useNum = document.getElementById('filter-num').checked;

            cleanDomains = rawDomains.filter(domain => {
                const parts = domain.split('.');
                const name = parts[0];
                const ext = parts[1];

                if (useExt && !PREMIUM_TLDS.includes(ext)) return false;
                if (useLen && name.length > 12) return false;
                if (useNum && /\d/.test(name)) return false;
                
                // ØªÙ†Ø¸ÙŠÙ Ø¥Ø¶Ø§ÙÙŠ: Ø§Ø³ØªØ¨Ø¹Ø§Ø¯ Ø§Ù„ØªÙƒØ±Ø§Ø± Ø§Ù„Ø´Ø¯ÙŠØ¯ (aaabbb)
                if (/(.)\1\1/.test(name)) return false; 

                return true;
            });

            // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            const container = document.getElementById('filtered-list');
            container.innerHTML = '';
            if (cleanDomains.length === 0) {
                container.innerHTML = '<div class="text-red-500 font-bold p-4">Ù„Ù… ÙŠÙ†Ø¬Ø­ Ø£ÙŠ Ø¯ÙˆÙ…ÙŠÙ† ÙÙŠ Ø§Ù„ÙÙ„ØªØ±Ø©! Ø­Ø§ÙˆÙ„ ØªØ®ÙÙŠÙ Ø§Ù„Ù‚ÙŠÙˆØ¯.</div>';
            } else {
                cleanDomains.forEach(d => {
                    container.innerHTML += `<div class="bg-white border border-slate-200 px-3 py-1 rounded-lg text-slate-700 font-mono shadow-sm">${d}</div>`;
                });
            }
        }

        function goToAnalysis() {
            if (cleanDomains.length === 0) return alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¯ÙˆÙ…ÙŠÙ†Ø§Øª Ù„ØªØ­Ù„ÙŠÙ„Ù‡Ø§!');
            switchStep(3);
            renderAnalysisTable();
        }

        // --- 4. SCORING ALGORITHM (Ø§Ù„Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Ø§Ù„Ø°ÙƒÙŠØ©) ---
        function calculateScore(domain) {
            const parts = domain.split('.');
            const name = parts[0];
            const ext = parts[1];
            
            let score = 50; // Ø¨Ø¯Ø§ÙŠØ©
            let tags = [];

            // 1. Forensic Check (Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠ)
            let isSpam = false;
            BAD_KEYWORDS.forEach(bad => {
                if (name.includes(bad)) {
                    score -= 40; 
                    tags.push('<span class="text-xs bg-red-100 text-red-700 px-2 py-0.5 rounded">âš ï¸ Risk</span>');
                    isSpam = true;
                }
            });

            // 2. Sniper Check (Ø§Ù„ØªØ±ÙŠÙ†Ø¯)
            TREND_KEYWORDS.forEach(trend => {
                if (name.includes(trend)) {
                    score += 15;
                    tags.push(`<span class="text-xs bg-purple-100 text-purple-700 px-2 py-0.5 rounded">ğŸ”¥ ${trend.toUpperCase()}</span>`);
                }
            });

            // 3. Expert Check (Ø§Ù„Ø¬ÙˆØ¯Ø©)
            if (name.length <= 4) {
                score += 30;
                tags.push('<span class="text-xs bg-yellow-100 text-yellow-700 px-2 py-0.5 rounded">ğŸ’ Rare 4L</span>');
            } else if (name.length <= 6) {
                score += 15;
            }

            // Ø§Ù„Ø§Ù…ØªØ¯Ø§Ø¯
            if (ext === 'ai') { score += 20; tags.push('<span class="text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded">ğŸ¤– AI</span>'); }
            if (ext === 'com') { score += 10; tags.push('<span class="text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded">ğŸ‘‘ COM</span>'); }

            // Ù†Ø·Ù‚ (Ø­Ø³Ø§Ø¨ Ø§Ù„Ø­Ø±ÙˆÙ Ø§Ù„Ù…ØªØ­Ø±ÙƒØ©)
            const vowels = (name.match(/[aeiou]/g) || []).length;
            if (vowels === 0 && name.length > 3) {
                score -= 10;
                tags.push('<span class="text-xs bg-gray-100 text-gray-600 px-2 py-0.5 rounded">Hard to say</span>');
            }

            // Cap score
            if (score > 100) score = 100;
            if (score < 0) score = 0;

            return { score, tags: tags.join(' ') };
        }

        function renderAnalysisTable() {
            const tbody = document.getElementById('analysis-table-body');
            tbody.innerHTML = '';
            
            // ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ Ø§Ù„Ø³ÙƒÙˆØ±
            const analyzedData = cleanDomains.map(d => ({ domain: d, ...calculateScore(d) }))
                                             .sort((a, b) => b.score - a.score);

            analyzedData.forEach(item => {
                let scoreColor = item.score > 75 ? 'text-green-500' : (item.score > 40 ? 'text-yellow-500' : 'text-red-500');
                
                let row = `
                    <tr class="border-b border-slate-100 hover:bg-slate-50 transition-all">
                        <td class="p-4 font-bold text-slate-800 text-lg">${item.domain}</td>
                        <td class="p-4 flex flex-wrap gap-1">${item.tags || '-'}</td>
                        <td class="p-4 font-black text-xl ${scoreColor}">${item.score}</td>
                        <td class="p-4">
                            <div class="flex gap-2">
                                <a href="https://www.godaddy.com/domain-value-appraisal/appraisal/?domainToCheck=${item.domain}" target="_blank" class="bg-slate-800 text-white px-3 py-1 rounded text-xs hover:bg-green-500 transition-colors">ğŸ’° Value</a>
                                <a href="https://web.archive.org/web/*/${item.domain}" target="_blank" class="bg-gray-200 text-gray-700 px-3 py-1 rounded text-xs hover:bg-gray-300 transition-colors">ğŸ•° History</a>
                            </div>
                        </td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        // --- UTILS ---
        function switchStep(step) {
            // UI Update
            for (let i = 1; i <= 3; i++) {
                document.getElementById(`view-step${i}`).classList.add('hidden');
                document.getElementById(`step${i}-badge`).classList.remove('step-active');
                if (i < step) document.getElementById(`step${i}-badge`).classList.add('step-done', 'border-slate-800');
                else document.getElementById(`step${i}-badge`).classList.add('step-inactive');
            }
            
            document.getElementById(`view-step${step}`).classList.remove('hidden');
            document.getElementById(`step${step}-badge`).classList.remove('step-inactive', 'step-done');
            document.getElementById(`step${step}-badge`).classList.add('step-active');
        }
    </script>
</body>
</html>
