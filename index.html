<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kheil Pro 3.0 - Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src='https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js'></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap');
        * { font-family: 'Cairo', sans-serif; }
        
        .gradient-bg { background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); }
        .card { background: white; border-radius: 12px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        
        /* Modal Styles */
        .modal { transition: opacity 0.25s ease; }
        body.modal-active { overflow-x: hidden; overflow-y: visible !important; }
        
        .score-circle {
            width: 60px; height: 60px; border-radius: 50%; display: flex;
            align-items: center; justify-content: center; font-weight: bold; font-size: 1.2rem;
            border: 4px solid #e2e8f0;
        }
        
        /* Analysis Bars */
        .bar-bg { background: #e2e8f0; height: 8px; border-radius: 4px; overflow: hidden; }
        .bar-fill { height: 100%; border-radius: 4px; transition: width 1s ease; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">

    <header class="gradient-bg text-white py-6 sticky top-0 z-40 shadow-lg">
        <div class="container mx-auto px-4 flex justify-between items-center">
            <h1 class="text-2xl font-black flex items-center gap-2">
                <i class="fa-solid fa-crosshairs text-green-400"></i> Kheil Pro <span class="text-xs bg-green-500 text-black px-2 py-0.5 rounded">Engine 3.0</span>
            </h1>
            <div class="text-sm opacity-80">Ù…Ø­Ø±Ùƒ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„Ù…Ø­Ù„ÙŠ</div>
        </div>
    </header>

    <div class="container mx-auto px-4 py-8 max-w-6xl">
        
        <div id="step-upload" class="card p-8 text-center mb-8">
            <h2 class="text-xl font-bold mb-4 text-gray-700">1. Ø£Ø¯Ø®Ù„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†Ø§Øª Ø£Ùˆ ØµÙˆØ±Ø©</h2>
            <div class="flex flex-col md:flex-row gap-4">
                <div class="flex-1 border-2 border-dashed border-gray-300 rounded-xl p-8 hover:bg-gray-50 cursor-pointer transition" onclick="document.getElementById('file-input').click()">
                    <input type="file" id="file-input" accept="image/*" class="hidden">
                    <i class="fa-solid fa-camera text-4xl text-gray-400 mb-2"></i>
                    <p>Ø±ÙØ¹ ØµÙˆØ±Ø© (OCR)</p>
                </div>
                <div class="flex-1">
                    <textarea id="manual-text" class="w-full h-full p-4 border rounded-xl" placeholder="Ø£Ùˆ Ø§Ù„ØµÙ‚ Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†Ø§Øª Ù‡Ù†Ø§..."></textarea>
                </div>
            </div>
            <button onclick="processInput()" class="mt-4 bg-gray-900 text-white px-8 py-3 rounded-lg font-bold hover:bg-gray-800 w-full md:w-auto">
                ğŸš€ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ
            </button>
            <div id="ocr-status" class="hidden mt-2 text-green-600 font-bold text-sm">Ø¬Ø§Ø±Ù Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ØµÙˆØ±Ø©... <span id="ocr-progress">0%</span></div>
        </div>

        <div id="step-results" class="hidden">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold">Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ÙØ­Øµ (<span id="count-result">0</span>)</h2>
                <div class="flex gap-2">
                    <span class="text-xs bg-white px-3 py-1 rounded border">âœ… .com/.ai ÙÙ‚Ø·</span>
                    <span class="text-xs bg-white px-3 py-1 rounded border">ğŸš« Ù„Ø§ Ø£Ø±Ù‚Ø§Ù…/Ù‡Ø§ÙŠÙÙ†</span>
                </div>
            </div>

            <div class="grid gap-4" id="results-grid">
                </div>
        </div>
    </div>

    <div id="report-modal" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center z-50">
        <div class="modal-overlay absolute w-full h-full bg-gray-900 opacity-50"></div>
        
        <div class="modal-container bg-white w-11/12 md:max-w-3xl mx-auto rounded-xl shadow-2xl z-50 overflow-y-auto max-h-[90vh]">
            <div class="modal-content py-4 text-left px-6">
                <div class="flex justify-between items-center pb-3 border-b">
                    <p class="text-2xl font-bold text-gray-800" id="modal-domain">domain.com</p>
                    <div class="cursor-pointer z-50" onclick="toggleModal()">
                        <i class="fa-solid fa-times text-2xl"></i>
                    </div>
                </div>

                <div class="grid md:grid-cols-3 gap-6 mt-6 text-center">
                    
                    <div class="bg-blue-50 p-4 rounded-xl border border-blue-100">
                        <div class="text-3xl mb-2">ğŸ‘®â€â™‚ï¸</div>
                        <h3 class="font-bold text-blue-800 mb-2">Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠ</h3>
                        <div class="flex justify-center mb-2">
                            <div class="score-circle text-blue-600 border-blue-200" id="score-forensic">0</div>
                        </div>
                        <ul class="text-xs text-right space-y-1 text-gray-600" id="list-forensic"></ul>
                    </div>

                    <div class="bg-purple-50 p-4 rounded-xl border border-purple-100">
                        <div class="text-3xl mb-2">ğŸ¯</div>
                        <h3 class="font-bold text-purple-800 mb-2">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù‚Ù†Ø§Øµ</h3>
                        <div class="flex justify-center mb-2">
                            <div class="score-circle text-purple-600 border-purple-200" id="score-sniper">0</div>
                        </div>
                        <ul class="text-xs text-right space-y-1 text-gray-600" id="list-sniper"></ul>
                    </div>

                    <div class="bg-green-50 p-4 rounded-xl border border-green-100">
                        <div class="text-3xl mb-2">ğŸ‘¨â€âš–ï¸</div>
                        <h3 class="font-bold text-green-800 mb-2">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø®Ø¨ÙŠØ±</h3>
                        <div class="flex justify-center mb-2">
                            <div class="score-circle text-green-600 border-green-200" id="score-expert">0</div>
                        </div>
                        <ul class="text-xs text-right space-y-1 text-gray-600" id="list-expert"></ul>
                    </div>
                </div>

                <div class="mt-6 bg-gray-50 p-4 rounded-xl">
                    <h4 class="font-bold text-gray-700 mb-3 text-sm">ğŸ” Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„ÙŠØ¯ÙˆÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ (Ù…Ø·Ù„ÙˆØ¨):</h4>
                    <div class="grid grid-cols-3 gap-3">
                        <a id="link-godaddy" target="_blank" class="bg-white border hover:bg-gray-100 text-center py-2 rounded text-sm font-bold text-green-600">
                            ğŸ’° GoDaddy Value
                        </a>
                        <a id="link-archive" target="_blank" class="bg-white border hover:bg-gray-100 text-center py-2 rounded text-sm font-bold text-blue-600">
                            ğŸ•° Wayback History
                        </a>
                        <a id="link-whois" target="_blank" class="bg-white border hover:bg-gray-100 text-center py-2 rounded text-sm font-bold text-gray-600">
                            ğŸ”’ Whois Check
                        </a>
                    </div>
                </div>

                <div class="flex justify-end pt-4 mt-4 border-t">
                    <button class="bg-gray-800 text-white px-6 py-2 rounded-lg hover:bg-gray-900" onclick="toggleModal()">Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- Kheil Pro 3.0 Logic Definitions ---
        const BAD_WORDS = ['cheap', 'free', 'buy', 'best', 'online', 'store', 'shop', 'sex', 'porn', 'hack', 'crack', 'spam', 'junk', 'get', 'try'];
        const TREND_WORDS = ['ai', 'gpt', 'tech', 'data', 'flow', 'soft', 'meta', 'chain', 'cloud', 'bot', 'lab', 'sys', 'agent', 'link', 'net', 'web', 'pay'];
        const HARD_TO_SAY = ['q', 'x', 'z', 'j']; // Letters that might hurt radio test if not used well

        let domainsData = [];

        // --- 1. Processing Logic ---
        function processInput() {
            const fileInput = document.getElementById('file-input');
            const textArea = document.getElementById('manual-text');
            
            if (fileInput.files.length > 0) {
                runOCR(fileInput.files[0]);
            } else if (textArea.value.trim().length > 0) {
                parseAndAnalyze(textArea.value);
            } else {
                alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø±ÙØ¹ ØµÙˆØ±Ø© Ø£Ùˆ ÙƒØªØ§Ø¨Ø© Ø¯ÙˆÙ…ÙŠÙ†Ø§Øª!");
            }
        }

        function runOCR(file) {
            document.getElementById('ocr-status').classList.remove('hidden');
            Tesseract.recognize(
                file, 'eng',
                { logger: m => { if (m.status === 'recognizing text') document.getElementById('ocr-progress').innerText = Math.floor(m.progress * 100) + '%'; }}
            ).then(({ data: { text } }) => {
                document.getElementById('ocr-status').classList.add('hidden');
                parseAndAnalyze(text);
            });
        }

        function parseAndAnalyze(text) {
            // Regex to find domains
            const regex = /[a-zA-Z0-9-]+\.[a-zA-Z]{2,4}/g;
            const matches = text.match(regex) || [];
            
            // Filter Logic (Hard Filters)
            const filtered = matches.map(d => d.toLowerCase()).filter(d => {
                const parts = d.split('.');
                const name = parts[0];
                const ext = parts[1];
                
                // Kheil Hard Filters:
                if (!['com', 'ai', 'io', 'net', 'co'].includes(ext)) return false; // Allowed Extensions
                if (name.length > 12) return false; // Max Length
                if (/\d/.test(name)) return false; // No Numbers
                if (name.includes('-')) return false; // No Hyphens
                if (/(.)\1\1/.test(name)) return false; // No triple letters (aaabbb)
                
                return true;
            });

            // Analyze each domain
            domainsData = filtered.map(d => runTriAnalysis(d));
            
            // Sort by Total Score
            domainsData.sort((a, b) => b.totalScore - a.totalScore);
            
            renderResults();
        }

        // --- 2. THE CORE ENGINE: TRI-ANALYSIS ---
        function runTriAnalysis(domain) {
            const parts = domain.split('.');
            const name = parts[0];
            const ext = parts[1];
            
            let report = {
                domain: domain,
                forensic: { score: 100, logs: [] },
                sniper: { score: 0, logs: [] },
                expert: { score: 50, logs: [] },
                totalScore: 0
            };

            // --- A. Forensic Analysis (Start at 100, deduct) ---
            // 1. Check Bad Words
            let hasBadWord = false;
            BAD_WORDS.forEach(w => {
                if (name.includes(w)) {
                    report.forensic.score -= 40;
                    report.forensic.logs.push(`âš ï¸ ÙƒÙ„Ù…Ø© Ø±Ø®ÙŠØµØ©: ${w}`);
                    hasBadWord = true;
                }
            });
            if (!hasBadWord) report.forensic.logs.push("âœ… Ø®Ø§Ù„Ù Ù…Ù† Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø³ÙŠØ¦Ø©");

            // 2. Length Risk
            if (name.length > 10) {
                report.forensic.score -= 10;
                report.forensic.logs.push("âš ï¸ Ø·ÙˆÙŠÙ„ Ù†Ø³Ø¨ÙŠØ§Ù‹ (Ø§Ø­ØªÙ…Ø§Ù„ Ø®Ø·Ø£ Ø¥Ù…Ù„Ø§Ø¦ÙŠ)");
            }

            // --- B. Sniper Analysis (Start at 0, add) ---
            // 1. Extension Value
            if (ext === 'ai') { 
                report.sniper.score += 40; 
                report.sniper.logs.push("ğŸ”¥ Ø§Ù…ØªØ¯Ø§Ø¯ Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ (.ai)");
            } else if (ext === 'com') {
                report.sniper.score += 30;
                report.sniper.logs.push("ğŸ‘‘ Ø§Ù„Ù…Ù„Ùƒ (.com)");
            } else {
                report.sniper.score += 10;
            }

            // 2. Trend Keywords
            let trendFound = false;
            TREND_WORDS.forEach(w => {
                if (name.includes(w)) {
                    report.sniper.score += 25;
                    report.sniper.logs.push(`ğŸš€ ÙƒÙ„Ù…Ø© ØªØ±ÙŠÙ†Ø¯: ${w.toUpperCase()}`);
                    trendFound = true;
                }
            });

            // 3. Liquidity (Short Length)
            if (name.length <= 4) {
                report.sniper.score += 30;
                report.sniper.logs.push("ğŸ’ Ø³ÙŠÙˆÙ„Ø© Ø¹Ø§Ù„ÙŠØ© (4 Ø£Ø­Ø±Ù)");
            } else if (name.length <= 6) {
                report.sniper.score += 15;
            }

            // --- C. Expert Analysis (Start at 50, adjust) ---
            // 1. Radio Test (Pronounceability)
            const vowels = (name.match(/[aeiouy]/g) || []).length;
            const ratio = vowels / name.length;
            
            if (ratio >= 0.2 && ratio <= 0.6) {
                report.expert.score += 20;
                report.expert.logs.push("ğŸ—£ï¸ Ù†Ø·Ù‚ Ù…ØªÙˆØ§Ø²Ù† (Radio Test Pass)");
            } else {
                report.expert.score -= 10;
                report.expert.logs.push("âŒ ØµØ¹Ø¨ Ø§Ù„Ù†Ø·Ù‚ (Ù†Ù‚Øµ/Ø²ÙŠØ§Ø¯Ø© Ø­Ø±ÙˆÙ Ø¹Ù„Ø©)");
            }

            // 2. Ambiguity Check
            let confusing = false;
            HARD_TO_SAY.forEach(char => {
                if (name.includes(char)) confusing = true;
            });
            if (confusing) {
                report.expert.score -= 15;
                report.expert.logs.push("âš ï¸ ÙŠØ­ØªÙˆÙŠ Ø­Ø±ÙˆÙ Ù…Ø±Ø¨ÙƒØ© (q,x,z)");
            } else {
                report.expert.logs.push("âœ… Ø­Ø±ÙˆÙ ÙˆØ§Ø¶Ø­Ø©");
            }
            
            // 3. Brandability (Repeating patterns)
            if (name.length % 2 === 0 && name.length <= 8) {
                 report.expert.score += 10; // Even numbers look better in logos often
            }

            // Normalize Scores (0-100)
            [report.forensic, report.sniper, report.expert].forEach(cat => {
                if (cat.score > 100) cat.score = 100;
                if (cat.score < 0) cat.score = 0;
            });

            // Weighted Average
            report.totalScore = Math.floor((report.forensic.score * 0.3) + (report.sniper.score * 0.4) + (report.expert.score * 0.3));

            return report;
        }

        // --- 3. UI Rendering ---
        function renderResults() {
            const grid = document.getElementById('results-grid');
            document.getElementById('step-upload').classList.add('hidden');
            document.getElementById('step-results').classList.remove('hidden');
            document.getElementById('count-result').innerText = domainsData.length;
            
            grid.innerHTML = '';

            if (domainsData.length === 0) {
                grid.innerHTML = `<div class="p-8 text-center text-gray-500">Ù„Ù… ÙŠÙ†Ø¬Ø­ Ø£ÙŠ Ø¯ÙˆÙ…ÙŠÙ† ÙÙŠ Ø§Ù„ÙÙ„ØªØ±Ø© Ø§Ù„Ù‚Ø§Ø³ÙŠØ©!</div>`;
                return;
            }

            domainsData.forEach((d, index) => {
                let badgeColor = d.totalScore > 75 ? 'bg-green-100 text-green-800' : (d.totalScore > 50 ? 'bg-yellow-100 text-yellow-800' : 'bg-red-100 text-red-800');
                
                let card = `
                <div class="card p-4 flex justify-between items-center hover:shadow-lg transition">
                    <div class="flex items-center gap-4">
                        <div class="font-black text-xl text-gray-800">${index + 1}.</div>
                        <div>
                            <div class="font-bold text-lg text-gray-900">${d.domain}</div>
                            <div class="text-xs text-gray-400">
                                ğŸ‘®â€â™‚ï¸ ${d.forensic.score} | ğŸ¯ ${d.sniper.score} | ğŸ‘¨â€âš–ï¸ ${d.expert.score}
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex items-center gap-4">
                        <div class="text-2xl font-black ${badgeColor.replace('bg-', 'text-').split(' ')[1]}">${d.totalScore}</div>
                        <button onclick="openReport(${index})" class="bg-gray-900 text-white px-4 py-2 rounded text-sm font-bold hover:bg-green-600 transition">
                            Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ğŸ“„
                        </button>
                    </div>
                </div>`;
                grid.innerHTML += card;
            });
        }

        // --- 4. Modal Logic ---
        function openReport(index) {
            const data = domainsData[index];
            
            document.getElementById('modal-domain').innerText = data.domain;
            
            // Set Scores
            setScore('forensic', data.forensic.score);
            setScore('sniper', data.sniper.score);
            setScore('expert', data.expert.score);
            
            // Set Logs
            setLogs('forensic', data.forensic.logs);
            setLogs('sniper', data.sniper.logs);
            setLogs('expert', data.expert.logs);
            
            // Set Links
            document.getElementById('link-godaddy').href = `https://www.godaddy.com/domain-value-appraisal/appraisal/?domainToCheck=${data.domain}`;
            document.getElementById('link-archive').href = `https://web.archive.org/web/*/${data.domain}`;
            document.getElementById('link-whois').href = `https://www.whois.com/whois/${data.domain}`;

            toggleModal();
        }

        function setScore(type, score) {
            const el = document.getElementById(`score-${type}`);
            el.innerText = score;
            // Color coding
            el.className = `score-circle ${score > 70 ? 'text-green-600 border-green-200' : (score > 40 ? 'text-yellow-600 border-yellow-200' : 'text-red-600 border-red-200')}`;
        }

        function setLogs(type, logs) {
            const list = document.getElementById(`list-${type}`);
            list.innerHTML = logs.map(l => `<li>${l}</li>`).join('');
        }

        function toggleModal() {
            const body = document.querySelector('body');
            const modal = document.querySelector('.modal');
            modal.classList.toggle('opacity-0');
            modal.classList.toggle('pointer-events-none');
            body.classList.toggle('modal-active');
        }
    </script>
</body>
</html>
